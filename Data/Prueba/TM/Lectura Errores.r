POROX13 <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/X13/Indicadores_TMPAXOUTLIERvsREVOUTLIER.csv"	
PORRX13 <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/X13/Indicadores_TMPAXOUTLIERvsREVREAL.csv"	
PRROX13 <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/X13/Indicadores_TMPAXREALvsREVOUTLIER.csv"	
PRRRX13 <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/X13/Indicadores_TMPAXREALvsREVREAL.csv"	

POROA <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/Arima/Indicadores_TMPAXOUTLIERvsREVOUTLIER.csv"	
PORRA <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/Arima/Indicadores_TMPAXOUTLIERvsREVREAL.csv"	
PRROA <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/Arima/Indicadores_TMPAXREALvsREVOUTLIER.csv"	
PRRRA <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/Arima/Indicadores_TMPAXREALvsREVREAL.csv"	

POROHW <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/HW/Indicadores_TMPAXOUTLIERvsREVOUTLIER.csv"	
PORRHW <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/HW/Indicadores_TMPAXOUTLIERvsREVREAL.csv"	
PRROHW <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/HW/Indicadores_TMPAXREALvsREVOUTLIER.csv"	
PRRRHW <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/HW/Indicadores_TMPAXREALvsREVREAL.csv"	

POROSTS <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/STS/Indicadores_TMPAXOUTLIERvsREVOUTLIER.csv"	
PORRSTS <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/STS/Indicadores_TMPAXOUTLIERvsREVREAL.csv"	
PRROSTS <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/STS/Indicadores_TMPAXREALvsREVOUTLIER.csv"	
PRRRSTS <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/STS/Indicadores_TMPAXREALvsREVREAL.csv"	

POROETS <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/ETS/Indicadores_TMPAXOUTLIERvsREVOUTLIER.csv"	
PORRETS <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/ETS/Indicadores_TMPAXOUTLIERvsREVREAL.csv"	
PRROETS <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/ETS/Indicadores_TMPAXREALvsREVOUTLIER.csv"	
PRRRETS <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/ETS/Indicadores_TMPAXREALvsREVREAL.csv"	

PORODT <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/Damped Trend/Indicadores_TMPAXOUTLIERvsREVOUTLIER.csv"	
PORRDT <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/Damped Trend/Indicadores_TMPAXOUTLIERvsREVREAL.csv"	
PRRODT <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/Damped Trend/Indicadores_TMPAXREALvsREVOUTLIER.csv"	
PRRRDT <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/Damped Trend/Indicadores_TMPAXREALvsREVREAL.csv"	

POROT <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/Theta/Indicadores_TMPAXOUTLIERvsREVOUTLIER.csv"	
PORRT <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/Theta/Indicadores_TMPAXOUTLIERvsREVREAL.csv"	
PRROT <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/Theta/Indicadores_TMPAXREALvsREVOUTLIER.csv"	
PRRRT <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/Theta/Indicadores_TMPAXREALvsREVREAL.csv"	

#POROF <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/F/Indicadores_TMPAXOUTLIERvsREVOUTLIER.csv"	
#PORRF <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/F/Indicadores_TMPAXOUTLIERvsREVREAL.csv"	
#PRROF <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/F/Indicadores_TMPAXREALvsREVOUTLIER.csv"	
#PRRRF <- "C:/Users/cdavalos/Documents/Pronostico TM/R/Indicadores/Prueba/TM/F/Indicadores_TMPAXREALvsREVREAL.csv"	

Rutas <- data.frame(RUTA = character(), METODO = character(), stringsAsFactors=F)

Rutas <- rbind(Rutas,data.frame(RUTA = POROX13, METODO = "X13", DATO = "PORO")) 
Rutas <- rbind(Rutas,data.frame(RUTA = PORRX13, METODO = "X13", DATO = "PORR")) 
Rutas <- rbind(Rutas,data.frame(RUTA = PRROX13, METODO = "X13", DATO = "PRRO")) 
Rutas <- rbind(Rutas,data.frame(RUTA = PRRRX13, METODO = "X13", DATO = "PRRR"))

Rutas <- rbind(Rutas,data.frame(RUTA = POROA, METODO = "Arima", DATO = "PORO")) 
Rutas <- rbind(Rutas,data.frame(RUTA = PORRA, METODO = "Arima", DATO = "PORR")) 
Rutas <- rbind(Rutas,data.frame(RUTA = PRROA, METODO = "Arima", DATO = "PRRO")) 
Rutas <- rbind(Rutas,data.frame(RUTA = PRRRA, METODO = "Arima", DATO = "PRRR"))

Rutas <- rbind(Rutas,data.frame(RUTA = POROHW, METODO = "HW", DATO = "PORO")) 
Rutas <- rbind(Rutas,data.frame(RUTA = PORRHW, METODO = "HW", DATO = "PORR")) 
Rutas <- rbind(Rutas,data.frame(RUTA = PRROHW, METODO = "HW", DATO = "PRRO")) 
Rutas <- rbind(Rutas,data.frame(RUTA = PRRRHW, METODO = "HW", DATO = "PRRR"))

Rutas <- rbind(Rutas,data.frame(RUTA = POROSTS, METODO = "STS", DATO = "PORO")) 
Rutas <- rbind(Rutas,data.frame(RUTA = PORRSTS, METODO = "STS", DATO = "PORR")) 
Rutas <- rbind(Rutas,data.frame(RUTA = PRROSTS, METODO = "STS", DATO = "PRRO")) 
Rutas <- rbind(Rutas,data.frame(RUTA = PRRRSTS, METODO = "STS", DATO = "PRRR"))

Rutas <- rbind(Rutas,data.frame(RUTA = POROETS, METODO = "ETS", DATO = "PORO")) 
Rutas <- rbind(Rutas,data.frame(RUTA = PORRETS, METODO = "ETS", DATO = "PORR")) 
Rutas <- rbind(Rutas,data.frame(RUTA = PRROETS, METODO = "ETS", DATO = "PRRO")) 
Rutas <- rbind(Rutas,data.frame(RUTA = PRRRETS, METODO = "ETS", DATO = "PRRR"))

Rutas <- rbind(Rutas,data.frame(RUTA = PORODT, METODO = "Damped Trend", DATO = "PORO")) 
Rutas <- rbind(Rutas,data.frame(RUTA = PORRDT, METODO = "Damped Trend", DATO = "PORR")) 
Rutas <- rbind(Rutas,data.frame(RUTA = PRRODT, METODO = "Damped Trend", DATO = "PRRO")) 
Rutas <- rbind(Rutas,data.frame(RUTA = PRRRDT, METODO = "Damped Trend", DATO = "PRRR"))

Rutas <- rbind(Rutas,data.frame(RUTA = POROT, METODO = "Theta", DATO = "PORO")) 
Rutas <- rbind(Rutas,data.frame(RUTA = PORRT, METODO = "Theta", DATO = "PORR")) 
Rutas <- rbind(Rutas,data.frame(RUTA = PRROT, METODO = "Theta", DATO = "PRRO")) 
Rutas <- rbind(Rutas,data.frame(RUTA = PRRRT, METODO = "Theta", DATO = "PRRR"))

#Rutas <- rbind(Rutas,data.frame(RUTA = POROF, METODO = "Forecast", DATO = "PORO")) 
#Rutas <- rbind(Rutas,data.frame(RUTA = PORRF, METODO = "Forecast", DATO = "PORR")) 
#Rutas <- rbind(Rutas,data.frame(RUTA = PRROF, METODO = "Forecast", DATO = "PRRO")) 
#Rutas <- rbind(Rutas,data.frame(RUTA = PRRRF, METODO = "Forecast", DATO = "PRRR"))

cantRutas <- nrow(Rutas)

Agregado <- data.frame(LEG_OW = character(), METODO = character(),TIPODATO = character(), ERROR = character(), VALOR = character(), stringsAsFactors=F)


for (z in 1:cantRutas){
	InputData <- read.table(toString(Rutas[z,1]), sep=" ", header=TRUE, fileEncoding="latin1")
	cantFilas <- nrow(InputData)
	cantColumnas <- ncol(InputData)
	
	for(j in 1:cantColumnas){
		for(i in 1:cantFilas){
			Vector <- data.frame(LEG_OW = colnames(InputData)[j], METODO = toString(Rutas[z,2]), TIPODATO = toString(Rutas[z,3]), ERROR = rownames(InputData)[i], VALOR = InputData[i,j])
			Agregado <- rbind(Agregado, Vector)
		}
	}
}	

setwd("C:/Users/cdavalos/Documents/Pronostico TM/R/Prueba/TM")

write.table(file="Indicadores_Consolidado.csv",Agregado, sep = ",")

cantMetodos <- length(unique(Rutas[,2]))

DATA_MAPE <- subset(Agregado,ERROR == "MAPE")
DATA_MAPE_SORT <- DATA_MAPE[order(DATA_MAPE[,1],DATA_MAPE[,3],DATA_MAPE[,5]),]

LLAVE <- data.frame(LLAVE=(paste(DATA_MAPE_SORT[,1],DATA_MAPE_SORT[,3])))
DATA_MAPE_SORT <- cbind(DATA_MAPE_SORT,LLAVE)
cantDatosMetodo <- as.data.frame(table(LLAVE))

datosMetodo <- dim(cantDatosMetodo)[1]

Clasificacion <- data.frame()

for(i in 1:datosMetodo){
	pos <- match(cantDatosMetodo[i,1],DATA_MAPE_SORT[,6])
	Clasificacion <- rbind(Clasificacion,DATA_MAPE_SORT[pos,])
}

setwd("C:/Users/cdavalos/Documents/Pronostico TM/R/Prueba/TM")

write.table(file="Clasificacion.csv",Clasificacion, sep = ",")





